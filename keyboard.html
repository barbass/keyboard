<!DOCTYPE html>

<html>

<head>
	<title>Клавиатура</title>
	<meta charset="utf-8" />
	
	<link type="text/css" href="stylesheet.css" rel="stylesheet" />
</head>

<body>
	
	<h4>Клавиатура</h4>
	
	<div class='et_block_keyboard'>
		
		<div class='et_keyboard_field'>
			<input type='text' class='et_keyboard_input' size='30' maxlength='30' placeholder='password'>
			<input type='button' onclick='mixing()' value='Обновить'>
		</div>
		
		<div class='et_keyboard_keys'>
			<div class='et_block_key'>
				<div class='et_key'>0</div>
				<input class='et_key_value' type='hidden' value='0' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>1</div>
				<input class='et_key_value' type='hidden' value='1' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>2</div>
				<input class='et_key_value' type='hidden' value='2' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>3</div>
				<input class='et_key_value' type='hidden' value='3' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>4</div>
				<input class='et_key_value' type='hidden' value='4' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>5</div>
				<input class='et_key_value' type='hidden' value='5' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>6</div>
				<input class='et_key_value' type='hidden' value='6' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>7</div>
				<input class='et_key_value' type='hidden' value='7' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>8</div>
				<input class='et_key_value' type='hidden' value='8' />
			</div>
			<div class='et_block_key'>
				<div class='et_key'>9</div>
				<input class='et_key_value' type='hidden' value='9' />
			</div>
		</div>
		
	</div>
	
<script type='text/javascript'>
	(function() {
		var keys = document.querySelectorAll('.et_block_keyboard .et_block_key');
		if (!keys || keys.length == 0) {
			return false;
		}
		for(var i=0; i<keys.length; i++ ) {
			document.querySelectorAll('.et_block_keyboard .et_block_key')[i].addEventListener(
				'click', function() {
					var password = document.querySelector('.et_block_keyboard .et_keyboard_field .et_keyboard_input').value + String(this.querySelector('.et_key_value').value);
					var maxlength = parseInt(document.querySelector('.et_block_keyboard .et_keyboard_field .et_keyboard_input').getAttribute('maxlength')) | 25;

					if (password.length > maxlength) {
						return false;
					}
					document.querySelector('.et_block_keyboard .et_keyboard_field .et_keyboard_input').value = password;
			}, false);
		}
		mixing();
	}());

	function mixing() {
		var keys = document.querySelectorAll(".et_block_keyboard .et_block_key");
		if (!keys || keys.length == 0) {
			return false;
		}

		//Сортируем индексы
		var sort_key = [];
		for(var i=0; i<keys.length; i++) {
			sort_key.push(i);
		}
		sort_key.sort(function() {return 0.5 - Math.random()});
		
		for(var i=0; i<keys.length; i++) {
			document.querySelector(".et_block_keyboard .et_keyboard_keys").appendChild(keys[sort_key[i]]);
		}

	}

</script>


</body>
</html>
